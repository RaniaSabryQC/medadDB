{
	"mappings": [
		{
			"priority": 1,
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"grant_type": {
						"absent": true
					}
				}
			},
			"response": {
				"status": 400,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error": "Bad grant type"
				}
			}
		},
		{
			"priority": 2,
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"grant_type": {
						"doesNotMatch": "authorization_code"
					}
				}
			},
			"response": {
				"status": 400,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error": "Bad grant type"
				}
			}
		},
		{
			"priority": 3,
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"code": {
						"absent": true
					}
				}
			},
			"response": {
				"status": 400,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error": "invalid_request",
					"error_description": "missingAuthzCode"
				}
			}
		},
		{
			"priority": 4,
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"redirect_uri": {
						"absent": true
					}
				}
			},
			"response": {
				"status": 400,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error": "invalid_request",
					"error_description": "Missing parameters: redirect_uri"
				}
			}
		},
		{
			"priority": 5,
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"client_id": {
						"or": [
							{ "absent": true },
							{ "doesNotMatch": "uaepass-client" }
						]
					}
				}
			},
			"response": {
				"status": 401,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error_description": "Unsupported Client Authentication Method!",
					"error": "invalid_client"
				}
			}
		},
		{
			"priority": 6,
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"client_secret": {
						"or": [
							{ "absent": true },
							{ "doesNotMatch": "uaepass-client-secret" }
						]
					}
				}
			},
			"response": {
				"status": 401,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error_description": "Unsupported Client Authentication Method!",
					"error": "invalid_client"
				}
			}
		},
		{
			"priority": 7,
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"code": {
						"doesNotMatch": "dc13889d-069e-31c4-bbf6-9c5fa73ace9e"
					}
				}
			},
			"response": {
				"status": 400,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error": "invalid_grant",
					"error_description": "Invalid authorization code received from token request"
				}
			}
		},
		{
			"priority": 8,
			"scenarioName": "AuthCodeLifecycle",
			"requiredScenarioState": "CODE_USED",
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"code": {
						"equalTo": "dc13889d-069e-31c4-bbf6-9c5fa73ace9e"
					}
				}
			},
			"response": {
				"status": 400,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error": "invalid_grant",
					"error_description": "Expired or Revoked authorization code received from token request"
				}
			}
		},
		{
			"priority": 9,
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"redirect_uri": {
						"doesNotMatch": "http://.+/realms/.+/broker/.+/endpoint"
					}
				}
			},
			"response": {
				"status": 400,
				"headers": {
					"Content-Type": "application/json"
				},
				"jsonBody": {
					"error": "invalid_grant",
					"error_description": "Callback url mismatch"
				}
			}
		},
		{
			"priority": 10,
			"scenarioName": "AuthCodeLifecycle",
			"requiredScenarioState": "CODE_ISSUED",
			"newScenarioState": "CODE_USED",
			"request": {
				"method": "POST",
				"urlPath": "/idshub/token",
				"formParameters": {
					"grant_type": {
						"equalTo": "authorization_code"
					},
					"code": {
						"equalTo": "dc13889d-069e-31c4-bbf6-9c5fa73ace9e"
					},
					"redirect_uri": {
						"matches": "http://.+/realms/.+/broker/.+/endpoint"
					},
					"client_id": {
						"equalTo": "uaepass-client"
					},
					"client_secret": {
						"equalTo": "uaepass-client-secret"
					}
				}
			},
			"response": {
				"status": 200,
				"headers": {
					"Content-Type": "application/json"
				},
				"bodyFileName": "token-response.json"
			}
		}
	]
}
